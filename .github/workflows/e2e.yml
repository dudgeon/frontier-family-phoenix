name: E2E
on:
  workflow_run:
    workflows: ["Test"]
    types:
      - completed

jobs:
  e2e:
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Set base URL
        run: echo "E2E_BASE_URL=https://example.com" >> $GITHUB_ENV
      - run: npm ci --legacy-peer-deps
      - run: npm run test:e2e
      - name: Upload coverage
        run: echo "Uploading LCOV"
      - name: Check coverage
        run: echo "fail if <80%"
